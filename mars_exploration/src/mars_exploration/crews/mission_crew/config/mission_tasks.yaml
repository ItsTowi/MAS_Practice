analyze_mission_report_task:
  description: >
    Read the mission report file located at {mission_report_path}.
    Extract and structure the following information:
    - Mission duration in sols
    - Primary scientific objectives
    - Operational constraints (energy limits, communication windows, etc.)
    - Known hazards mentioned in the report
    - Target location for exploration

    Parse the terrain data from {terrain_data_path} to understand the available nodes and connectivity.

    Provide a comprehensive structured summary that other agents can use as foundation.
  expected_output: >
    A MissionReportSummary object containing:
    - mission_duration_sols: integer
    - primary_objectives: list of objective descriptions
    - operational_constraints: dictionary mapping constraint names to descriptions
    - communication_windows: list of time windows
    - known_hazards: list of initially identified hazards
  agent: mission_planner

assess_hazards_task:
  description: >
    Analyze the mission context and terrain data to identify and classify all hazards.
    For each hazard:
    1. Determine the hazard type (dust_storm, radiation_zone, steep_cliff, unstable_terrain)
    2. Assess the risk level (Low, Medium, High, Critical)
    3. Identify all affected node IDs from the terrain graph
    4. Determine time windows when the hazard is active (if applicable)
    5. Provide specific safety recommendations

    Also identify:
    - Safe zones where rovers/drones can operate without restrictions
    - Nodes that should be completely restricted
    - Emergency protocols for each hazard type
  expected_output: >
    A HazardAssessmentOutput object containing:
    - hazard_zones: detailed list of HazardZone objects
    - safe_zones: list of safe node IDs
    - restricted_nodes: list of nodes to avoid
    - emergency_protocols: dictionary of protocols per hazard type
  agent: hazard_assessment


optimize_resources_task:
  description: >
    Allocate mission resources (energy, bandwidth, communication time) across
    all operational components to maximize mission efficiency.
    
    Consider:
    - Total energy budget for rovers, drones, and satellites
    - Communication bandwidth limitations
    - Time constraints for each mission phase
    - Energy consumption patterns for different terrains
    - Buffer reserves for emergencies (minimum 15% recommended)
    
    Identify potential bottlenecks:
    - Energy shortfalls for planned operations
    - Communication window conflicts
    - Over-allocation of any resource
    
    Provide optimization recommendations to improve resource utilization.
  expected_output: >
    A ResourceOptimizationOutput object containing:
    - allocations: list of ResourceAllocation objects for each resource type
    - bottleneck_warnings: list of identified issues
    - optimization_recommendations: actionable suggestions for improvement
  agent: resource_optimization

prioritize_science_task:
  description: >
    Evaluate all scientific objectives and assign priorities based on:
    - Scientific value (novelty, importance to mission goals)
    - Feasibility (accessibility, energy requirements, safety)
    - Resource efficiency (samples per energy unit)
    - Strategic importance (enables other objectives)
    
    Take into account:
    - Hazard zones identified by the Hazard Assessment Agent
    - Resource constraints from the Resource Optimization Agent
    - Mission timeline and operational windows
    
    Rank objectives from highest to lowest priority and provide detailed
    justification for each ranking decision.
    
    Identify backup targets in case primary objectives become infeasible.
  expected_output: >
    A ScientificPrioritizationOutput object containing:
    - prioritized_objectives: list of ScientificObjective objects (sorted by priority)
    - high_value_targets: top 3-5 target locations
    - backup_targets: alternative locations if primaries fail
  agent: scientific_target_evaluator

synthesize_final_plan_task:
  description: >
    Integrate all outputs from Mission Planner, Hazard Assessment, Resource
    Optimization, and Scientific Target Evaluator into a single coherent
    master mission plan.
    
    Resolve any conflicts between:
    - Scientific priorities and safety constraints
    - Resource allocations and operational requirements
    - Timeline feasibility and objective priorities
    
    The final plan must:
    1. Provide an executive summary of the mission strategy
    2. List prioritized scientific objectives with full details
    3. Document all hazard zones and safety protocols
    4. Specify final resource allocations
    5. Clearly mark restricted areas and safe routes
    6. Include critical constraints that MUST be followed
    7. Provide contingency plans for common failure scenarios
    
    This plan will be consumed by Rover, Drone, and Satellite crews, so it must
    be clear, unambiguous, and actionable.
    
    Output the plan both as structured data (Pydantic model) and as a formatted
    Markdown document for human review.
  expected_output: >
    A MasterMissionPlan object containing complete mission strategy with:
    - mission_summary: executive overview
    - scientific_priorities: final ranked objectives
    - hazard_zones: all identified hazards
    - resource_allocations: final resource distribution
    - restricted_areas: nodes to avoid
    - safe_routes: recommended paths
    - critical_constraints: must-follow rules
    - contingency_plans: backup strategies
  agent: decision_synthesizer